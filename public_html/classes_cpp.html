<html> <head> <title>MiMeS</title> <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script> <script type="module" src="https://cdn.jsdelivr.net/gh/zerodevx/zero-md@2/dist/zero-md.min.js"></script> </head> <style> @import url('https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@500&display=swap'); code {font-family: 'Source Code Pro', monospace; color: rgb(0,0,0);} </style> <body style="background-color:rgb\(255, 255, 255\)\;">
<h2 id="classes-in-c">Classes in <code>C++</code></h2>
<h3 id="the-cosmo-class">The <code>Cosmo</code> class</h3>
<p>The <code>mimes::Cosmo&lt; LD &gt;</code> class is used to interpolate various quantities of the plasma. It is defined inside the header file <code>MiMeS/src/Cosmo/Cosmo.hpp</code>. The constructor is</p>
<pre><code class="prettyprint">
    template< class LD >
    mimes::Cosmo< LD >(std::string cosmo_PATH, LD minT=0, LD maxT=mimes::Cosmo< LD >::mP)
</code></pre>
<p>The argument <code>cosmo_PATH</code> is the path of the data file that contains <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math> (in <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mi>e</mi><mi>V</mi></mrow><annotation encoding="application/x-tex">GeV</annotation></semantics></math>), <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>h</mi><mrow><mi>e</mi><mi>f</mi><mi>f</mi></mrow></msub><annotation encoding="application/x-tex">h_{eff}</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mrow><mi>e</mi><mi>f</mi><mi>f</mi></mrow></msub><annotation encoding="application/x-tex">g_{eff}</annotation></semantics></math>, with increasing <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>. The parameters <code>minT</code> and <code>maxT</code> are minimum and maximum interpolation temperatures. These temperatures are just limits, and the action interpolation is done between the closest temperatures in the data file. Moreover, beyond the interpolation temperatures, both <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>h</mi><mrow><mi>e</mi><mi>f</mi><mi>f</mi></mrow></msub><annotation encoding="application/x-tex">h_{eff}</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mrow><mi>e</mi><mi>f</mi><mi>f</mi></mrow></msub><annotation encoding="application/x-tex">g_{eff}</annotation></semantics></math> are assumed to be constants.</p>
<p>Interpolation of the RDOF, allows us to define various quantities related to the plasma; that is. These quantities are given as the member functions:</p>
<ol>
<li>
<code class="prettyprint">template&lt; class LD &gt; LD mimes::Cosmo&lt; LD &gt;::heff(LD T)</code>: <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>h</mi><mrow><mi>e</mi><mi>f</mi><mi>f</mi></mrow></msub><annotation encoding="application/x-tex">h_{eff}</annotation></semantics></math> as a function of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>.
</li>
<li>
<code class="prettyprint">template&lt; class LD &gt; LD mimes::Cosmo&lt; LD &gt;::geff(LD T)</code>: <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mrow><mi>e</mi><mi>f</mi><mi>f</mi></mrow></msub><annotation encoding="application/x-tex">g_{eff}</annotation></semantics></math> as a function of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>.
</li>
<li>
<code class="prettyprint">template&lt; class LD &gt; LD mimes::Cosmo&lt; LD &gt;::dheffdT(LD T)</code>: <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>h</mi><mrow><mi>e</mi><mi>f</mi><mi>f</mi></mrow></msub><mi>/</mi><mi>d</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">dh_{eff}/dT</annotation></semantics></math> as a function of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>.
</li>
<li>
<code class="prettyprint">template&lt; class LD &gt; LD mimes::Cosmo&lt; LD &gt;::dgeffdT(LD T)</code>: <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi>g</mi><mrow><mi>e</mi><mi>f</mi><mi>f</mi></mrow></msub><mi>/</mi><mi>d</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">dg_{eff}/dT</annotation></semantics></math> as a function of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>.
</li>
<li>
<code class="prettyprint">template&lt; class LD &gt; LD mimes::Cosmo&lt; LD &gt;::dh(LD T)</code>: <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>δ</mi><mi>h</mi></msub><mo>=</mo><mn>1</mn><mo>+</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mfrac><mrow><mi>d</mi><mo>log</mo><msub><mi>h</mi><mrow><mi>e</mi><mi>f</mi><mi>f</mi></mrow></msub></mrow><mrow><mi>d</mi><mo>log</mo><mi>T</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\delta_h = 1 + \frac{1}{3} \frac{d\log h_{eff}}{d\log T}</annotation></semantics></math> as a function of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>.
</li>
<li>
<code class="prettyprint">template&lt; class LD &gt; LD mimes::Cosmo&lt; LD &gt;::s(LD T)</code>: The entropy density of the plasma as a function of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>.
</li>
<li>
<code class="prettyprint">template&lt; class LD &gt; LD mimes::Cosmo&lt; LD &gt;::rhoR(LD T)</code>: The energy density of the plasma as a function of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>.
</li>
<li>
<code class="prettyprint">template&lt; class LD &gt; LD mimes::Cosmo&lt; LD &gt;::Hubble(LD T)</code>: The Hubble parameter assuming radiation dominated expansion as a function of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>.
</li>
</ol>
<p>Moreover, there are several cosmological quantities are given as members variables:<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<ol>
<li>
<code class="prettyprint">template&lt; class LD &gt; constexpr static LD mimes::Cosmo&lt; LD &gt;::T0</code>: CMB temperature today in <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mi>e</mi><mi>V</mi></mrow><annotation encoding="application/x-tex">GeV</annotation></semantics></math>.
</li>
<li>
<code class="prettyprint">template&lt; class LD &gt; constexpr static LD mimes::Cosmo&lt; LD &gt;::h_hub</code>: Dimensionless Hubble constant.
</li>
<li>
<code class="prettyprint">template&lt; class LD &gt; constexpr static LD mimes::Cosmo&lt; LD &gt;::rho_crit</code>: Critical density in <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mi>e</mi><msup><mi>V</mi><mn>3</mn></msup></mrow><annotation encoding="application/x-tex">GeV^3</annotation></semantics></math>.
</li>
<li>
<code class="prettyprint">template&lt; class LD &gt; constexpr static LD mimes::Cosmo&lt; LD &gt;::relicDM_obs</code>: Central value of the measured DM relic abundance.
</li>
<li>
<code class="prettyprint">template&lt; class LD &gt; constexpr static LD mimes::Cosmo&lt; LD &gt;::mP</code>: Planck mass in <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mi>e</mi><mi>V</mi></mrow><annotation encoding="application/x-tex">GeV</annotation></semantics></math>.
</li>
</ol>
<h3 id="the-axionmass-class">The <code>AxionMass</code> class</h3>
<p>The <code>mimes::AxionMass&lt;LD&gt;</code> class is responsible for the definition of the axion mass. The header file of this class is <code>\mimes/src/AxionMass/AxionMass.hpp</code>.</p>
The class has two constructors. The first one is
<pre><code class="prettyprint">
    template< class LD >
    mimes::AxionMass<LD>(std::string chi_PATH, LD minT=0, LD maxT=mimes::Cosmo::mP)
</code></pre>
<p>The first argument, <code>chi\_PATH</code>, is the path to a data file that contains two columns; <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math> (in <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mi>e</mi><mi>V</mi></mrow><annotation encoding="application/x-tex">GeV</annotation></semantics></math>) and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>χ</mi><annotation encoding="application/x-tex">\chi</annotation></semantics></math> (in <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mi>e</mi><msup><mi>V</mi><mn>4</mn></msup></mrow><annotation encoding="application/x-tex">GeV^4</annotation></semantics></math>), with increasing <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>. The arguments <code>minT</code> and <code>maxT</code> are the interpolation limits. These limits are used in order to stop the interpolation in the closest temperatures that exist in the data file. That is the actual interpolation limits are <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mo>min</mo></msub><mo>≥</mo></mrow><annotation encoding="application/x-tex">T_{\min}\geq</annotation></semantics></math><code>minT</code> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mo>max</mo></msub><mo>≤</mo></mrow><annotation encoding="application/x-tex">T_{\max}\leq</annotation></semantics></math><code>maxT</code>. Beyond these limits, by default, the axion mass is assumed to be constant. However, this can be changed by using the member functions</p>
<pre><code class="prettyprint">
    void set_ma2_MIN(std::function<LD(LD,LD)> ma2_MIN)
    void set_ma2_MAX(std::function<LD(LD,LD)> ma2_MAX)
</code></pre>
<p>Here, <code>ma2_MIN</code> and <code>ma2_MAX</code> are functors that define the axion mass squared beyond the interpolation limits. In order to ensure that the axion mass is continuous, usually we need <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mo>min</mo></msub><annotation encoding="application/x-tex">T_{\min}</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mo>max</mo></msub><annotation encoding="application/x-tex">T_{\max}</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>χ</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>T</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\chi(T_{ min})</annotation></semantics></math>, and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>χ</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>T</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\chi(T_{ max})</annotation></semantics></math>. These values can be obtained using the member functions</p>
<ol>
<li>
<code class="prettyprint">template&lt; class LD &gt; LD mimes::AxionMass<LD>::getTMin()</code>: This function returns the minimum interpolation temperature, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub><annotation encoding="application/x-tex">T_{ min}</annotation></semantics></math>.
</li>
<li>
<code class="prettyprint">template&lt; class LD &gt; LD mimes::AxionMass<LD>::getTMax()</code>: This function returns the maximum interpolation temperature, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">T_{ max}</annotation></semantics></math>.
</li>
<li>
<code class="prettyprint">template&lt; class LD &gt; LD mimes::AxionMass<LD>::getChiMin()</code>: This function returns <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>χ</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>T</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\chi(T_{ min})</annotation></semantics></math>.
</li>
<li>
<code class="prettyprint">template&lt; class LD &gt; LD mimes::AxionMass<LD>::getChiMax()</code>: This function returns <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>χ</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>T</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\chi(T_{ max})</annotation></semantics></math>.
</li>
</ol>
An alternative way to define the axion mass is via the constructor
<pre><code class="prettyprint">
    template< class LD >
    mimes::AxionMass<LD>(std::function<LD(LD,LD)> ma2)
</code></pre>
<p>Here, the only argument is the axion mass squared, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>m</mi><mo accent="true">̃</mo></mover><mi>a</mi></msub><mo stretchy="false" form="prefix">(</mo><mi>T</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\tilde{m}_a(T)</annotation></semantics></math>, defined as a callable object.</p>
Once an instance of the class is defined, we can get <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover><mi>m</mi><mo accent="true">̃</mo></mover><mi>a</mi><mn>2</mn></msubsup><mo stretchy="false" form="prefix">(</mo><mi>T</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\tilde{m}^2_a(T)</annotation></semantics></math> using the member function
<pre><code class="prettyprint">
    template< class LD >    LD mimes::AxionMass<LD>::ma2(LD T, LD fa)
</code></pre>
<p>We should note that <code>ma2</code> is a public <code>std::function&lt;LD(LD,LD)&gt;</code> member variable. Therefore, it can be assigned using the assignment operator. However, in order to change its definition, we can also use the following member function:</p>
<pre><code class="prettyprint">
    template< class LD > void mimes::AxionMass<LD>::set_ma2(std::function<LD(LD,LD)> ma2)
</code></pre>
<h3 id="the-axion-class">The <code>Axion</code> class</h3>
The <code>mimes::Axion&lt;LD,Solver,Method&gt;</code> class is the class that combines all the others, and actually solves the axion EOM. Its header file is <code>\mimes/src/Axion/AxionSolve.hpp</code> and its constructor is
<pre><code class="prettyprint">
    template<class LD, const int Solver, class Method>
    mimes::Axion< LD, Solver, Method >(LD theta_i, LD fa, LD umax, LD TSTOP, 
                    LD ratio_ini, unsigned int N_convergence_max, LD convergence_lim, 
                    std::string inputFile, AxionMass<LD> *axionMass, LD initial_step_size=1e-2, 
                    LD minimum_step_size=1e-8, LD maximum_step_size=1e-2, LD absolute_tolerance=1e-8, 
                    LD relative_tolerance=1e-8, LD beta=0.9, LD fac_max=1.2, LD fac_min=0.8, 
                    unsigned int maximum_No_steps=10000000)
</code></pre>
<p>The various arguments are :</p>
<section class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Taken from <a href="https://inspirehep.net/literature/1812251">PRD</a> and the <a href="https://inspirehep.net/literature/1682902">Planck Collaboration</a>.<a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</section>
</body> </html>
